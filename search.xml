<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[sequelize的基本使用]]></title>
      <url>https://yujintang.github.io/2016/06/20/sequelize%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<blockquote>
<p><a href="http://docs.sequelizejs.com/en/latest/" target="_blank" rel="external">sequelize官方文档</a><br><a href="http://itbilu.com/nodejs/npm/VkYIaRPz-.html" target="_blank" rel="external">参考文章1</a><br><a href="http://itbilu.com/nodejs/npm/V1PExztfb.html" target="_blank" rel="external">参考文章2</a><br><a href="http://itbilu.com/nodejs/npm/41qaV3czb.html" target="_blank" rel="external">参考文章3</a></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install sequelize --save</span><br></pre></td></tr></table></figure>
</blockquote>
<p>###基本使用</p>
<p>####事务<br>启动一个事物，可以在多个数据库操作时具有失败会滚效果。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sequelize.transaction(function (t) &#123; </span><br><span class="line">  // 注意，这时使用的是callback而不是promise.then()</span><br><span class="line">  return User.find(..., &#123; transaction: t&#125;).then(function (user) &#123;</span><br><span class="line">    return user.updateAttributes(..., &#123; transaction: t&#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;).then(function () &#123;</span><br><span class="line">  // Committed</span><br><span class="line">&#125;).catch(function (err) &#123;</span><br><span class="line">  // Rolled back</span><br><span class="line">  console.error(err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>####查询<br>过滤语法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">where:判断的字段  attributes:返回的内容 include: 多表 limit:返回最大个数 offset:忽略前几条数据</span><br></pre></td></tr></table></figure></p>
<p>#####findAll查询多条数据，返回数组</p>
<blockquote>
<p>相关：findOne 查找单挑数据，findById 根据id查找，count 统计个数， findAndCount 返回rows和count<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Model.findAll(&#123;</span><br><span class="line">  where: &#123;</span><br><span class="line">    attr1: 42,</span><br><span class="line">    attr2: &apos;cake&apos;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">// WHERE attr1 = 42 AND attr2 = &apos;cake&apos;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>#####saveById 保存某条数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[post传递数组问题]]></title>
      <url>https://yujintang.github.io/2016/06/20/post%E4%BC%A0%E9%80%92%E6%95%B0%E7%BB%84%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>###前端post方法传递数组<br>前端post方法传递数组arr时候，会出现后端接受到后数组名变为arr[]，解决方法如下：</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">  url: &apos;c/info_nickname.do&apos;,</span><br><span class="line">  data: JSON.stringify(&#123;nickname: &apos;ABC&apos;, a: [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;]&#125;),</span><br><span class="line">  success: function(result)&#123;console.log(result)&#125;,</span><br><span class="line">  dataType: &apos;json&apos;,</span><br><span class="line">  type: &apos;POST&apos;,</span><br><span class="line">  contentType: &apos;application/json&apos;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[lodash基本使用]]></title>
      <url>https://yujintang.github.io/2016/06/20/lodash%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<blockquote>
<p><a href="http://lodashjs.com/docs/" target="_blank" rel="external">参考地址</a></p>
</blockquote>
<hr>
<h3 id="merge-合并对象"><a href="#merge-合并对象" class="headerlink" title="_.merge    合并对象"></a>_.merge    合并对象</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">var users = &#123;</span><br><span class="line">  &apos;data&apos;: [&#123; &apos;user&apos;: &apos;barney&apos; &#125;, &#123; &apos;user&apos;: &apos;fred&apos; &#125;]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var ages = &#123;</span><br><span class="line">  &apos;data&apos;: [&#123; &apos;age&apos;: 36 &#125;, &#123; &apos;age&apos;: 40 &#125;]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">_.merge(users, ages);</span><br><span class="line">// =&gt; &#123; &apos;data&apos;: [&#123; &apos;user&apos;: &apos;barney&apos;, &apos;age&apos;: 36 &#125;, &#123; &apos;user&apos;: &apos;fred&apos;, &apos;age&apos;: 40 &#125;] &#125;</span><br><span class="line"></span><br><span class="line">// using a customizer callback</span><br><span class="line">var object = &#123;</span><br><span class="line">  &apos;fruits&apos;: [&apos;apple&apos;],</span><br><span class="line">  &apos;vegetables&apos;: [&apos;beet&apos;]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var other = &#123;</span><br><span class="line">  &apos;fruits&apos;: [&apos;banana&apos;],</span><br><span class="line">  &apos;vegetables&apos;: [&apos;carrot&apos;]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">_.merge(object, other, function(a, b) &#123;</span><br><span class="line">  if (_.isArray(a)) &#123;</span><br><span class="line">    return a.concat(b);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">// =&gt; &#123; &apos;fruits&apos;: [&apos;apple&apos;, &apos;banana&apos;], &apos;vegetables&apos;: [&apos;beet&apos;, &apos;carrot&apos;] &#125;</span><br></pre></td></tr></table></figure>
<h3 id="omit-从对象中删除某个属性"><a href="#omit-从对象中删除某个属性" class="headerlink" title="_.omit  从对象中删除某个属性"></a>_.omit  从对象中删除某个属性</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var object = &#123; &apos;user&apos;: &apos;fred&apos;, &apos;age&apos;: 40 &#125;;</span><br><span class="line"></span><br><span class="line">_.omit(object, &apos;age&apos;);</span><br><span class="line">// =&gt; &#123; &apos;user&apos;: &apos;fred&apos; &#125;</span><br><span class="line"></span><br><span class="line">_.omit(object, _.isNumber);</span><br><span class="line">// =&gt; &#123; &apos;user&apos;: &apos;fred&apos; &#125;</span><br></pre></td></tr></table></figure>
<h3 id="pick-从对象中增加某个属性"><a href="#pick-从对象中增加某个属性" class="headerlink" title="_.pick 从对象中增加某个属性"></a>_.pick 从对象中增加某个属性</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var object = &#123; &apos;user&apos;: &apos;fred&apos;, &apos;age&apos;: 40 &#125;;</span><br><span class="line"></span><br><span class="line">_.pick(object, &apos;user&apos;);</span><br><span class="line">// =&gt; &#123; &apos;user&apos;: &apos;fred&apos; &#125;</span><br><span class="line"></span><br><span class="line">_.pick(object, _.isString);</span><br><span class="line">// =&gt; &#123; &apos;user&apos;: &apos;fred&apos; &#125;</span><br></pre></td></tr></table></figure>
<h3 id="set-设置对象的某个属性值"><a href="#set-设置对象的某个属性值" class="headerlink" title="_.set  设置对象的某个属性值"></a>_.set  设置对象的某个属性值</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var object = &#123; &apos;a&apos;: [&#123; &apos;b&apos;: &#123; &apos;c&apos;: 3 &#125; &#125;] &#125;;</span><br><span class="line"></span><br><span class="line">_.set(object, &apos;a[0].b.c&apos;, 4);</span><br><span class="line">console.log(object.a[0].b.c);</span><br><span class="line">// =&gt; 4</span><br><span class="line"></span><br><span class="line">_.set(object, &apos;x[0].y.z&apos;, 5);</span><br><span class="line">console.log(object.x[0].y.z);</span><br><span class="line">// =&gt; 5</span><br></pre></td></tr></table></figure>
<h3 id="cloneDeep-深度克隆"><a href="#cloneDeep-深度克隆" class="headerlink" title="_.cloneDeep    深度克隆"></a>_.cloneDeep    深度克隆</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var objA = &#123;</span><br><span class="line">	&quot;name&quot;: &quot;colin&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Normal method? Too long. See Stackoverflow for solution: http://stackoverflow.com/questions/4459928/how-to-deep-clone-in-javascript</span><br><span class="line"></span><br><span class="line">// Lodash</span><br><span class="line">var objB = _.cloneDeep(objA);</span><br><span class="line">objB === objA // false</span><br></pre></td></tr></table></figure>
<h3 id="findKey-选择查找属性"><a href="#findKey-选择查找属性" class="headerlink" title="_.findKey    选择查找属性"></a>_.findKey    选择查找属性</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">var users = &#123;</span><br><span class="line">  &apos;barney&apos;:  &#123; &apos;age&apos;: 36, &apos;active&apos;: true &#125;,</span><br><span class="line">  &apos;fred&apos;:    &#123; &apos;age&apos;: 40, &apos;active&apos;: false &#125;,</span><br><span class="line">  &apos;pebbles&apos;: &#123; &apos;age&apos;: 1,  &apos;active&apos;: true &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">_.findKey(users, function(chr) &#123;</span><br><span class="line">  return chr.age &lt; 40;</span><br><span class="line">&#125;);</span><br><span class="line">// =&gt; &apos;barney&apos; (iteration order is not guaranteed)</span><br><span class="line"></span><br><span class="line">// using the `_.matches` callback shorthand</span><br><span class="line">_.findKey(users, &#123; &apos;age&apos;: 1, &apos;active&apos;: true &#125;);</span><br><span class="line">// =&gt; &apos;pebbles&apos;</span><br><span class="line"></span><br><span class="line">// using the `_.matchesProperty` callback shorthand</span><br><span class="line">_.findKey(users, &apos;active&apos;, false);</span><br><span class="line">// =&gt; &apos;fred&apos;</span><br><span class="line"></span><br><span class="line">// using the `_.property` callback shorthand</span><br><span class="line">_.findKey(users, &apos;active&apos;);</span><br><span class="line">// =&gt; &apos;barney&apos;</span><br></pre></td></tr></table></figure>
<h3 id="transform-返回一个修改后的对象"><a href="#transform-返回一个修改后的对象" class="headerlink" title="_.transform 返回一个修改后的对象"></a>_.transform 返回一个修改后的对象</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">_.transform([2, 3, 4], function(result, n) &#123;</span><br><span class="line">  result.push(n *= n);</span><br><span class="line">  return n % 2 == 0;</span><br><span class="line">&#125;);</span><br><span class="line">// =&gt; [4, 9]</span><br><span class="line"></span><br><span class="line">_.transform(&#123; &apos;a&apos;: 1, &apos;b&apos;: 2 &#125;, function(result, n, key) &#123;</span><br><span class="line">  result[key] = n * 3;</span><br><span class="line">&#125;);</span><br><span class="line">// =&gt; &#123; &apos;a&apos;: 3, &apos;b&apos;: 6 &#125;</span><br></pre></td></tr></table></figure>
]]></content>
    </entry>
    
  
  
</search>
