<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/uploads/favicon.ico?v=5.0.1" />






<meta name="description" content="靡不有初,鲜克有终">
<meta property="og:type" content="website">
<meta property="og:title" content="技术分享">
<meta property="og:url" content="https://yujintang.github.io/index.html">
<meta property="og:site_name" content="技术分享">
<meta property="og:description" content="靡不有初,鲜克有终">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="技术分享">
<meta name="twitter:description" content="靡不有初,鲜克有终">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="https://yujintang.github.io/"/>

  <title> 技术分享 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?09c5d4daddb9b6250ba93075257e58a2";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">技术分享</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/13/如何使用gitlab-pipelines/" itemprop="url">
                  如何使用gitlab pipelines
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-03-13T10:09:16+08:00" content="2018-03-13">
              2018-03-13
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/03/13/如何使用gitlab-pipelines/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/03/13/如何使用gitlab-pipelines/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/03/13/如何使用gitlab-pipelines/" class="leancloud_visitors" data-flag-title="如何使用gitlab pipelines">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="gitlab-ci-yml"><a href="#gitlab-ci-yml" class="headerlink" title=".gitlab-ci.yml"></a>.gitlab-ci.yml</h3><h4 id="1-什么是yaml语言"><a href="#1-什么是yaml语言" class="headerlink" title="1.什么是yaml语言?"></a>1.什么是yaml语言?</h4><p><strong>yaml 是一门专门来写配置文件的语言</strong><br><a href="http://www.ruanyifeng.com/blog/2016/07/yaml.html" target="_blank" rel="external">yaml语言教程</a></p>
<h5 id="1-1-语法规则"><a href="#1-1-语法规则" class="headerlink" title="1.1.语法规则"></a>1.1.语法规则</h5><ol>
<li>大小写敏感</li>
<li>使用缩进表示层级关系</li>
<li>缩进时不允许使用Tab键，只允许使用空格。</li>
<li>缩进的空格数目不重要，只要相同层级的元素左侧对齐即可<h5 id="1-2-数据结构"><a href="#1-2-数据结构" class="headerlink" title="1.2 数据结构"></a>1.2 数据结构</h5></li>
<li><p>对象：键值对的集合，又称为映射（mapping）/ 哈希（hashes） / 字典（dictionary）</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attr">animal:</span> pets</div><div class="line"><span class="comment"># &#123;animal: 'pets'&#125;</span></div></pre></td></tr></table></figure>
</li>
<li><p>数组：一组按次序排列的值，又称为序列（sequence） / 列表（list）</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="bullet">-</span> Cat</div><div class="line"><span class="bullet">-</span> Dog</div><div class="line"><span class="bullet">-</span> Goldfish</div><div class="line"><span class="comment"># ['Cat', 'Dog', 'Goldfish']</span></div></pre></td></tr></table></figure>
</li>
<li><p>复合结构</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="attr">languages:</span></div><div class="line"><span class="bullet"> -</span> Ruby </div><div class="line"><span class="attr">websites:</span></div><div class="line"><span class="attr"> YAML:</span> yaml.org </div><div class="line"><span class="comment"># &#123; languages: [ 'Ruby'],websites: &#123; YAML: 'yaml.org'&#125; &#125;</span></div></pre></td></tr></table></figure>
</li>
<li><p>纯量（scalars）：单个的、不可再分的值</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="attr">number:</span> <span class="number">12.30</span></div><div class="line"><span class="comment"># 数字 &#123; number: 12.30 &#125;</span></div><div class="line"><span class="attr">isSet:</span> <span class="literal">true</span></div><div class="line"><span class="comment"># 布尔值 &#123; isSet: true &#125;</span></div><div class="line"><span class="attr">parent:</span> ~ </div><div class="line"><span class="comment"># null值 &#123; parent: null &#125;</span></div><div class="line"><span class="attr">iso8601:</span> <span class="number">2001</span><span class="bullet">-12</span><span class="bullet">-14</span>t21:<span class="number">59</span>:<span class="number">43.10</span><span class="bullet">-05</span>:<span class="number">00</span> </div><div class="line"><span class="comment"># 时间，采用ISO8601格式，&#123; iso8601: new Date('2001-12-14t21:59:43.10-05:00') &#125;</span></div><div class="line"><span class="attr">date:</span> <span class="number">1976</span><span class="bullet">-07</span><span class="bullet">-31</span></div><div class="line"><span class="comment"># 日期采用复合 iso8601 格式的年、月、日表示 &#123; date: new Date('1976-07-31') &#125;</span></div><div class="line"><span class="attr">e:</span> <span class="type">!!str</span> <span class="number">123</span></div><div class="line"><span class="attr">f:</span> <span class="type">!!str</span> <span class="literal">true</span></div><div class="line"><span class="comment"># YAML 允许使用两个感叹号，强制转换数据类型。&#123; e: '123', f: 'true' &#125;</span></div><div class="line"><span class="attr">str:</span> 这是一行字符串</div><div class="line"><span class="comment"># 字符串默认不使用引号表示。&#123; str: '这是一行字符串' &#125;</span></div><div class="line"><span class="attr">str:</span> <span class="string">'内容： 字符串'</span></div><div class="line"><span class="comment"># 如果字符串之中包含空格或特殊字符，需要放在引号之中。&#123; str: '内容: 字符串' &#125;</span></div><div class="line"><span class="attr">s1:</span> <span class="string">'内容\n字符串'</span></div><div class="line"><span class="attr">s2:</span> <span class="string">"内容\n字符串"</span></div><div class="line"><span class="comment"># 单引号和双引号都可以使用，双引号不会对特殊字符转义。&#123; s1: '内容\\n字符串', s2: '内容\n字符串' &#125;</span></div><div class="line"><span class="attr">str:</span> <span class="string">'labor'</span><span class="string">'s day'</span> </div><div class="line"><span class="comment"># 单引号之中如果还有单引号，必须连续使用两个单引号转义。&#123; str: 'labor\'s day' &#125;</span></div><div class="line"><span class="attr">str:</span> 这是一段</div><div class="line">  多行</div><div class="line">  字符串</div><div class="line"><span class="comment"># 字符串可以写成多行，从第二行开始，必须有一个单空格缩进。换行符会被转为空格。&#123; str: '这是一段 多行 字符串' &#125;</span></div><div class="line"><span class="attr">this:</span> <span class="string">|</span></div><div class="line">  Foo</div><div class="line">  Bar</div><div class="line"><span class="attr">that:</span> <span class="string">&gt;</span></div><div class="line">  Foo</div><div class="line">  Bar</div><div class="line"># 多行字符串可以使用|保留换行符，也可以使用&gt;折叠换行。&#123; this: 'Foo\nBar\n', that: 'Foo Bar\n' &#125;</div><div class="line"><span class="attr">s1:</span> <span class="string">|</span></div><div class="line">  Foo</div><div class="line"></div><div class="line"><span class="attr">s2:</span> |+</div><div class="line">  Foo</div><div class="line"></div><div class="line"></div><div class="line"><span class="attr">s3:</span> |-</div><div class="line">  Foo</div><div class="line"><span class="comment"># +表示保留文字块末尾的换行，-表示删除字符串末尾的换行。&#123; s1: 'Foo\n', s2: 'Foo\n\n\n', s3: 'Foo' &#125;</span></div><div class="line"><span class="attr">message:</span> <span class="string">|</span></div><div class="line"></div><div class="line">  &lt;p style="color: red"&gt;</div><div class="line">    段落</div><div class="line">  &lt;/p&gt;</div><div class="line"># 字符串之中可以插入 HTML 标记。&#123; message: '\n&lt;p style="color: red"&gt;\n  段落\n&lt;/p&gt;\n' &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>引用<br><strong>锚点&amp;和别名<em>，可以用来引用。&amp;用来建立锚点（defaults），&lt;&lt;表示合并到当前数据，\</em>用来引用锚点。</strong> </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="attr">defaults:</span> <span class="meta">&amp;defaults</span></div><div class="line"><span class="attr">  adapter:</span>  postgres</div><div class="line"><span class="attr">  host:</span>     localhost</div><div class="line"></div><div class="line"><span class="attr">development:</span></div><div class="line"><span class="attr">  database:</span> myapp_development</div><div class="line">  &lt;&lt;: <span class="meta">*defaults</span></div><div class="line"></div><div class="line"><span class="attr">test:</span></div><div class="line"><span class="attr">  database:</span> myapp_test</div><div class="line">  &lt;&lt;: <span class="meta">*defaults</span></div></pre></td></tr></table></figure>
</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="attr">defaults:</span></div><div class="line"><span class="attr">  adapter:</span>  postgres</div><div class="line"><span class="attr">  host:</span>     localhost</div><div class="line"></div><div class="line"><span class="attr">development:</span></div><div class="line"><span class="attr">  database:</span> myapp_development</div><div class="line"><span class="attr">  adapter:</span>  postgres</div><div class="line"><span class="attr">  host:</span>     localhost</div><div class="line"></div><div class="line"><span class="attr">test:</span></div><div class="line"><span class="attr">  database:</span> myapp_test</div><div class="line"><span class="attr">  adapter:</span>  postgres</div><div class="line"><span class="attr">  host:</span>     localhost</div></pre></td></tr></table></figure>
<h4 id="2-gitlab-ci-yml-具体配置"><a href="#2-gitlab-ci-yml-具体配置" class="headerlink" title="2.  .gitlab-ci.yml 具体配置"></a>2.  .gitlab-ci.yml 具体配置</h4><p><a href="https://docs.gitlab.com/ee/ci/yaml/" target="_blank" rel="external">gitlab .gitlab-ci doc</a></p>
<h5 id="2-1-Jobs"><a href="#2-1-Jobs" class="headerlink" title="2.1. Jobs"></a>2.1. Jobs</h5><p><strong>定义任务，可以有多个任务</strong><br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="attr">job1:</span></div><div class="line"><span class="attr">  script:</span> <span class="string">"execute-script-for-job1"</span></div><div class="line"></div><div class="line"><span class="attr">job2:</span></div><div class="line"><span class="attr">  script:</span> <span class="string">"execute-script-for-job2"</span></div></pre></td></tr></table></figure></p>
<p>⚠️：<strong>不能使用以下关键字：image, services, stages, types, before_script, after_script, variables, cache</strong></p>
<h5 id="2-2-before-script-and-after-script"><a href="#2-2-before-script-and-after-script" class="headerlink" title="2.2. before_script and after_script"></a>2.2. before_script and after_script</h5><p><strong>所有job执行前与执行后执行的脚本</strong><br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="attr">before_script:</span></div><div class="line"><span class="bullet">-</span> global before script</div><div class="line"></div><div class="line"><span class="attr">job:</span></div><div class="line"><span class="attr">  before_script:</span></div><div class="line"><span class="bullet">  -</span> execute this instead of global before script</div><div class="line"><span class="attr">  script:</span></div><div class="line"><span class="bullet">  -</span> my command</div><div class="line"><span class="attr">  after_script:</span></div><div class="line"><span class="bullet">  -</span> execute this after my script</div></pre></td></tr></table></figure></p>
<p>⚠️：<strong>可以在job里覆盖before_script and after_script</strong></p>
<h5 id="2-3-stage"><a href="#2-3-stage" class="headerlink" title="2.3 stage"></a>2.3 stage</h5><p><strong>pipelines 执行阶段,原字段为types(弃用)</strong><br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="attr">stages:</span></div><div class="line"><span class="bullet">  -</span> build</div><div class="line"><span class="bullet">  -</span> test</div><div class="line"><span class="bullet">  -</span> deploy</div><div class="line"></div><div class="line">job <span class="number">1</span>:</div><div class="line"><span class="attr">  stage:</span> build</div><div class="line"><span class="attr">  script:</span> make build dependencies</div><div class="line"></div><div class="line">job <span class="number">2</span>:</div><div class="line"><span class="attr">  stage:</span> build</div><div class="line"><span class="attr">  script:</span> make build artifacts</div><div class="line"></div><div class="line">job <span class="number">3</span>:</div><div class="line"><span class="attr">  stage:</span> test</div><div class="line"><span class="attr">  script:</span> make test</div><div class="line"></div><div class="line">job <span class="number">4</span>:</div><div class="line"><span class="attr">  stage:</span> deploy</div><div class="line"><span class="attr">  script:</span> make deploy</div></pre></td></tr></table></figure></p>
<h5 id="2-4-script"><a href="#2-4-script" class="headerlink" title="2.4 script"></a>2.4 script</h5><p><strong>Job 执行的脚本</strong><br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="attr">job:</span></div><div class="line"><span class="attr">  script:</span></div><div class="line"><span class="bullet">    -</span> uname -a</div><div class="line"><span class="bullet">    -</span> bundle exec rspec</div></pre></td></tr></table></figure></p>
<h5 id="2-5-only-and-except"><a href="#2-5-only-and-except" class="headerlink" title="2.5 only and except"></a>2.5 only and except</h5><p><strong>Job在什么时候创建或除了什么创建，使用以下关键词：branches、tags、api、等</strong><br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="attr">job:</span></div><div class="line">  <span class="comment"># use regexp</span></div><div class="line"><span class="attr">  only:</span></div><div class="line"><span class="bullet">    -</span> /^issue-.*$/</div><div class="line">  <span class="comment"># use special keyword</span></div><div class="line"><span class="attr">  except:</span></div><div class="line"><span class="bullet">    -</span> branches</div></pre></td></tr></table></figure></p>
<h5 id="2-6-tags"><a href="#2-6-tags" class="headerlink" title="2.6 tags"></a>2.6 tags</h5><p><strong>tags用于指定Job运行具体的gitlab-runner</strong><br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="attr">job:</span></div><div class="line"><span class="attr">  tags:</span></div><div class="line"><span class="bullet">    -</span> ruby</div><div class="line"><span class="bullet">    -</span> postgres</div></pre></td></tr></table></figure></p>
<h5 id="2-7-when"><a href="#2-7-when" class="headerlink" title="2.7 when"></a>2.7 when</h5><p><strong>Job的运行方式 on_success、on_failure、always、manual</strong><br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="attr">stages:</span></div><div class="line"><span class="bullet">-</span> build</div><div class="line"><span class="bullet">-</span> cleanup_build</div><div class="line"><span class="bullet">-</span> test</div><div class="line"><span class="bullet">-</span> deploy</div><div class="line"><span class="bullet">-</span> cleanup</div><div class="line"></div><div class="line"><span class="attr">build_job:</span></div><div class="line"><span class="attr">  stage:</span> build</div><div class="line"><span class="attr">  script:</span></div><div class="line"><span class="bullet">  -</span> make build</div><div class="line"></div><div class="line"><span class="attr">cleanup_build_job:</span></div><div class="line"><span class="attr">  stage:</span> cleanup_build</div><div class="line"><span class="attr">  script:</span></div><div class="line"><span class="bullet">  -</span> cleanup build when failed</div><div class="line"><span class="attr">  when:</span> on_failure</div><div class="line"></div><div class="line"><span class="attr">test_job:</span></div><div class="line"><span class="attr">  stage:</span> test</div><div class="line"><span class="attr">  script:</span></div><div class="line"><span class="bullet">  -</span> make test</div><div class="line"></div><div class="line"><span class="attr">deploy_job:</span></div><div class="line"><span class="attr">  stage:</span> deploy</div><div class="line"><span class="attr">  script:</span></div><div class="line"><span class="bullet">  -</span> make deploy</div><div class="line"><span class="attr">  when:</span> manual</div><div class="line"></div><div class="line"><span class="attr">cleanup_job:</span></div><div class="line"><span class="attr">  stage:</span> cleanup</div><div class="line"><span class="attr">  script:</span></div><div class="line"><span class="bullet">  -</span> cleanup after jobs</div><div class="line"><span class="attr">  when:</span> always</div></pre></td></tr></table></figure></p>
<h5 id="2-8-cache"><a href="#2-8-cache" class="headerlink" title="2.8 cache"></a>2.8 cache</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 根据CI_JOB_NAME进行缓存，缓存git未跟踪文件,文件位置在 logs／</span></div><div class="line"><span class="attr">cache:</span></div><div class="line"><span class="attr">  key:</span> <span class="string">"$CI_JOB_NAME"</span></div><div class="line"><span class="attr">  untracked:</span> <span class="literal">true</span></div><div class="line"><span class="attr">  paths:</span></div><div class="line"><span class="bullet">   -</span> logs/</div></pre></td></tr></table></figure>
<h5 id="3-example"><a href="#3-example" class="headerlink" title="3 example"></a>3 example</h5><p><a href="https://docs.gitlab.com/ee/ci/examples/README.html" target="_blank" rel="external">例子</a></p>
<h3 id="gitlab-runner"><a href="#gitlab-runner" class="headerlink" title="gitlab-runner"></a>gitlab-runner</h3><p><a href="https://docs.gitlab.com/runner/" target="_blank" rel="external">Runner</a></p>
<h4 id="1-mac-环境"><a href="#1-mac-环境" class="headerlink" title="1.mac 环境"></a>1.mac 环境</h4><h5 id="1-1-下载"><a href="#1-1-下载" class="headerlink" title="1.1 下载"></a>1.1 下载</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo curl --output /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-darwin-amd64</div></pre></td></tr></table></figure>
<h5 id="1-2-赋权"><a href="#1-2-赋权" class="headerlink" title="1.2 赋权"></a>1.2 赋权</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chmod +x /usr/local/bin/gitlab-runner</div></pre></td></tr></table></figure>
<h5 id="1-3-启动一个Runner"><a href="#1-3-启动一个Runner" class="headerlink" title="1.3 启动一个Runner"></a>1.3 启动一个Runner</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd ~</div><div class="line">gitlab-runner install</div><div class="line">gitlab-runner start</div></pre></td></tr></table></figure>
<h5 id="1-4-注册"><a href="#1-4-注册" class="headerlink" title="1.4 注册"></a>1.4 注册</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo gitlab-runner register</div></pre></td></tr></table></figure>
<h5 id="1-5-输入gitlab-URL"><a href="#1-5-输入gitlab-URL" class="headerlink" title="1.5 输入gitlab URL"></a>1.5 输入gitlab URL</h5><h5 id="1-6-输入token"><a href="#1-6-输入token" class="headerlink" title="1.6 输入token"></a>1.6 输入token</h5><h5 id="1-7-输入描述"><a href="#1-7-输入描述" class="headerlink" title="1.7 输入描述"></a>1.7 输入描述</h5><h5 id="1-8-输入标签"><a href="#1-8-输入标签" class="headerlink" title="1.8 输入标签"></a>1.8 输入标签</h5><h5 id="1-9-输入Runner执行的语言"><a href="#1-9-输入Runner执行的语言" class="headerlink" title="1.9 输入Runner执行的语言"></a>1.9 输入Runner执行的语言</h5><p><img src="1.jpg" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/26/javaScript传值调用还是传引用调用/" itemprop="url">
                  javaScript传值调用还是传引用调用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-01-26T17:14:00+08:00" content="2018-01-26">
              2018-01-26
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/01/26/javaScript传值调用还是传引用调用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/01/26/javaScript传值调用还是传引用调用/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/01/26/javaScript传值调用还是传引用调用/" class="leancloud_visitors" data-flag-title="javaScript传值调用还是传引用调用">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://nodejh.com/post/is-javascript-a-pass-by-reference-or-pass-by-value-language/" target="_blank" rel="external">参考文章链接</a></p>
<p><strong>js是按值传递，本质上传递的是变量的值的拷贝</strong></p>
<h3 id="详细解释"><a href="#详细解释" class="headerlink" title="详细解释"></a>详细解释</h3><h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeStuff</span>(<span class="params">a, b, c</span>) </span>&#123;</div><div class="line">  a = a * <span class="number">10</span>;</div><div class="line">  b.item = <span class="string">"changed"</span>;</div><div class="line">  c = &#123;item: <span class="string">"changed"</span>&#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> num = <span class="number">10</span>;</div><div class="line"><span class="keyword">var</span> obj1 = &#123;item: <span class="string">"unchanged"</span>&#125;;</div><div class="line"><span class="keyword">var</span> obj2 = &#123;item: <span class="string">"unchanged"</span>&#125;;</div><div class="line"></div><div class="line">changeStuff(num, obj1, obj2);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(num);<span class="comment">//10</span></div><div class="line"><span class="built_in">console</span>.log(obj1.item); <span class="comment">//changed</span></div><div class="line"><span class="built_in">console</span>.log(obj2.item); <span class="comment">//unchanged</span></div></pre></td></tr></table></figure>
<h4 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h4><ol>
<li><strong>传值调用（Pass by value）</strong><br>在传值调用中，传递给函数参数是函数被调用时所传实参的拷贝。在传值调用中实际参数被求值，其值被绑定到函数中对应的变量上（通常是把值复制到新内存区域）</li>
<li><strong>传引用调用（Pass by reference）</strong><br>在传引用调用调用中，传递给函数的是它的实际参数的隐式引用而不是实参的拷贝。通常函数能够修改这些参数（比如赋值），而且改变对于调用者是可见的。</li>
<li><strong>传共享调用（Call by sharing）</strong><br>还有一种求值策略叫做传共享调用（Call-by-sharing/Call by object/Call by object-sharing）。<br>传共享调用和传引用调用的不同之处是，该求值策略传递给函数的参数是对象的引用的拷贝，即对象变量指针的拷贝</li>
</ol>
<h4 id="result"><a href="#result" class="headerlink" title="result"></a>result</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeStuff</span>(<span class="params">a, b, c</span>) </span>&#123;</div><div class="line">  a = a * <span class="number">10</span>; <span class="comment">// 对 a 赋值，修改 a 的指向，新的值是 a * 10</span></div><div class="line">  b.item = <span class="string">"changed"</span>; <span class="comment">// 因为 b 与 obj1 指向同一个对象，所以这里会修改原始对象 obj1.item 的内容</span></div><div class="line">  c = &#123;item: <span class="string">"changed"</span>&#125;; <span class="comment">// 对 c 重新赋值，修改 c 的指向，其指向的对象内容是 &#123;item: "changed"&#125;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="代码分析"><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h3><h4 id="1-变量初始化"><a href="#1-变量初始化" class="headerlink" title="1. 变量初始化"></a>1. 变量初始化</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> num = <span class="number">10</span>;</div><div class="line"><span class="keyword">var</span> obj1 = &#123;item: <span class="string">"unchanged"</span>&#125;;</div><div class="line"><span class="keyword">var</span> obj2 = &#123;item: <span class="string">"unchanged"</span>&#125;;</div></pre></td></tr></table></figure>
<p><img src="1.jpg" alt=""></p>
<h4 id="2-调用函数"><a href="#2-调用函数" class="headerlink" title="2.调用函数"></a>2.调用函数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">changeStuff(num, obj1, obj2);</div></pre></td></tr></table></figure>
<p><img src="2.jpg" alt=""></p>
<h4 id="3-执行函数体"><a href="#3-执行函数体" class="headerlink" title="3.执行函数体"></a>3.执行函数体</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">a = a * <span class="number">10</span>;</div><div class="line">b.item = <span class="string">"changed"</span>;</div><div class="line">c = &#123;item: <span class="string">"changed"</span>&#125;;</div></pre></td></tr></table></figure>
<p><img src="3.jpg" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/22/测试/" itemprop="url">
                  测试
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-01-22T19:47:13+08:00" content="2018-01-22">
              2018-01-22
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/01/22/测试/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/01/22/测试/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/01/22/测试/" class="leancloud_visitors" data-flag-title="测试">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>上发生的发生</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/22/event-loop详解/" itemprop="url">
                  event_loop详解
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-01-22T10:43:45+08:00" content="2018-01-22">
              2018-01-22
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/01/22/event-loop详解/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/01/22/event-loop详解/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2018/01/22/event-loop详解/" class="leancloud_visitors" data-flag-title="event_loop详解">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Event-Loop-详解"><a href="#Event-Loop-详解" class="headerlink" title="Event Loop 详解"></a>Event Loop 详解</h2><p><a href="https://juejin.im/post/5a6155126fb9a01cb64edb45" target="_blank" rel="external">掘金原文链接🔗</a></p>
<h3 id="Event-Loop-基本流程："><a href="#Event-Loop-基本流程：" class="headerlink" title="Event Loop 基本流程："></a>Event Loop 基本流程：</h3><ol>
<li>queue可以看做一种数据结构，用以存储需要执行的函数</li>
<li>timer类型的API（setTimeout/setInterval）注册的函数，等到期后进入task队列（这里不详细展开timer的运行机制）</li>
<li>其余API注册函数直接进入自身对应的task/microtask队列</li>
<li>Event Loop执行一次，从task队列中拉出一个task执行</li>
<li>Event Loop继续检查microtask队列是否为空，依次执行直至清空队列<br><img src="https://user-gold-cdn.xitu.io/2018/1/19/1610c344b595114b?" alt=""></li>
</ol>
<h3 id="补充："><a href="#补充：" class="headerlink" title="补充："></a>补充：</h3><ul>
<li>Node的Event Loop分阶段，阶段有先后，依次是</li>
</ul>
<ol>
<li>expired timers and intervals，即到期的setTimeout/setInterval</li>
<li>I/O events，包含文件，网络等等</li>
<li>immediates，通过setImmediate注册的函数</li>
<li>close handlers，close事件的回调，比如TCP连接断开</li>
</ol>
<ul>
<li>同步任务及每个阶段之后都会清空microtask队列</li>
</ul>
<ol>
<li>优先清空next tick queue，即通过process.nextTick注册的函数</li>
<li>再清空other queue，常见的如Promise</li>
</ol>
<ul>
<li>而和规范的区别，在于node会清空当前所处阶段的队列，即执行所有task</li>
</ul>
<p><img src="https://user-gold-cdn.xitu.io/2018/1/18/16109e54b46036d1?" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/14/git版本控制学习/" itemprop="url">
                  “git版本控制学习”
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-09-14T12:03:20+08:00" content="2017-09-14">
              2017-09-14
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/09/14/git版本控制学习/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/09/14/git版本控制学习/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2017/09/14/git版本控制学习/" class="leancloud_visitors" data-flag-title="“git版本控制学习”">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#git版本控制学习</p>
<h2 id="版本库"><a href="#版本库" class="headerlink" title="版本库"></a>版本库</h2><p><img src="https://www.liaoxuefeng.com/files/attachments/001384907702917346729e9afbf4127b6dfbae9207af016000/0" alt=""></p>
<h2 id="1-创建仓库。"><a href="#1-创建仓库。" class="headerlink" title="1.创建仓库。"></a>1.创建仓库。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git init</div></pre></td></tr></table></figure>
<h2 id="2-添加文件到git仓库"><a href="#2-添加文件到git仓库" class="headerlink" title="2.添加文件到git仓库"></a>2.添加文件到git仓库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git add &lt;file&gt; #添加到暂存区</div><div class="line">git commit #添加提交备注</div><div class="line">git commit --amend #修改提交备注</div></pre></td></tr></table></figure>
<h2 id="3-查看工作区状态"><a href="#3-查看工作区状态" class="headerlink" title="3.查看工作区状态"></a>3.查看工作区状态</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git status</div></pre></td></tr></table></figure>
<h2 id="4-查看内容"><a href="#4-查看内容" class="headerlink" title="4.查看内容"></a>4.查看内容</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git diff</div></pre></td></tr></table></figure>
<h2 id="5-查看历史记录"><a href="#5-查看历史记录" class="headerlink" title="5.查看历史记录"></a>5.查看历史记录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git log  #查看提交历史</div><div class="line">git log --pretty=oneline</div><div class="line">git reflog #查看命令历史</div><div class="line">git log --graph #查看分支合并图</div></pre></td></tr></table></figure>
<h2 id="6-时光穿梭机"><a href="#6-时光穿梭机" class="headerlink" title="6.时光穿梭机"></a>6.时光穿梭机</h2><p><strong>Git必须知道当前版本是哪个版本，在Git中，用HEAD表示当前版本，也就是最新的提交3628164…882e1e0（注意我的提交ID和你的肯定不一样），上一个版本就是HEAD^，上上一个版本就是HEAD^^，当然往上100个版本写100个^比较容易数不过来，所以写成HEAD~100， 或者使用comment id</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">git reset #没有push</div><div class="line"> 	--mixed               reset HEAD and index</div><div class="line">    --soft                reset only HEAD</div><div class="line">    --hard                reset HEAD, index and working tree</div><div class="line">    --merge               reset HEAD, index and working tree</div><div class="line">git revert #已经push用一个新提交来消除一个历史提交所做的任何修改.</div></pre></td></tr></table></figure></p>
<ol>
<li>上面我们说的如果你已经push到线上代码库, reset 删除指定commit以后,你git push可能导致一大堆冲突.但是revert 并不会.</li>
<li>如果在日后现有分支和历史分支需要合并的时候,reset 恢复部分的代码依然会出现在历史分支里.但是revert 方向提交的commit 并不会出现在历史分支里.</li>
<li>reset 是在正常的commit历史中,删除了指定的commit,这时 HEAD 是向后移动了,而 revert 是在正常的commit历史中再commit一次,只不过是反向提交,他的 HEAD 是一直向前的.<h2 id="7-丢掉工作区修改"><a href="#7-丢掉工作区修改" class="headerlink" title="7.丢掉工作区修改"></a>7.丢掉工作区修改</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git checkout -- readme.txt</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="8-丢掉暂存区的修改，放到工作区"><a href="#8-丢掉暂存区的修改，放到工作区" class="headerlink" title="8.丢掉暂存区的修改，放到工作区"></a>8.丢掉暂存区的修改，放到工作区</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git reset HEAD readme.txt</div></pre></td></tr></table></figure>
<h2 id="9-删除一个文件"><a href="#9-删除一个文件" class="headerlink" title="9.删除一个文件"></a>9.删除一个文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git rm text.txt</div><div class="line">git commit -m &apos;rm text.txt&apos;</div></pre></td></tr></table></figure>
<h2 id="10-关联远程库"><a href="#10-关联远程库" class="headerlink" title="10.关联远程库"></a>10.关联远程库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git remote add origin git@server-name:path/repo-name.git</div></pre></td></tr></table></figure>
<h2 id="11-推送分支"><a href="#11-推送分支" class="headerlink" title="11.推送分支"></a>11.推送<name>分支</name></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git push -u origin &lt;name&gt; #第一次推送  -u 参数</div><div class="line">git push origin &lt;name&gt;</div></pre></td></tr></table></figure>
<h2 id="12-克隆一个远程库"><a href="#12-克隆一个远程库" class="headerlink" title="12. 克隆一个远程库"></a>12. 克隆一个远程库</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone git@server-name:path/repo-name.git</div></pre></td></tr></table></figure>
<h2 id="13-查看分支"><a href="#13-查看分支" class="headerlink" title="13. 查看分支"></a>13. 查看分支</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git branch</div></pre></td></tr></table></figure>
<h2 id="14-创建分支"><a href="#14-创建分支" class="headerlink" title="14.创建分支"></a>14.创建分支</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git checkout -b dev </div><div class="line">#git checkout命令加上-b参数表示创建并切换，相当于：</div><div class="line">$ git branch dev  #新增dev分支</div><div class="line">$ git checkout dev</div></pre></td></tr></table></figure>
<h2 id="15-合并某分支到当前分支"><a href="#15-合并某分支到当前分支" class="headerlink" title="15. 合并某分支到当前分支"></a>15. 合并某分支到当前分支</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git merge &lt;name&gt;</div></pre></td></tr></table></figure>
<h2 id="16-删除分支"><a href="#16-删除分支" class="headerlink" title="16.删除分支"></a>16.删除分支</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git branch -d dev </div><div class="line">git branch -D &lt;name&gt; #删除一个没有被合并过的分支</div></pre></td></tr></table></figure>
<h2 id="17-解决冲突"><a href="#17-解决冲突" class="headerlink" title="17.解决冲突"></a>17.解决冲突</h2><p><strong>Git用&lt;&lt;&lt;&lt;&lt;&lt;&lt;，=======，&gt;&gt;&gt;&gt;&gt;&gt;&gt;标记出不同分支的内容 </strong></p>
<h2 id="18-保存现场，（开发过程插入临时任务）"><a href="#18-保存现场，（开发过程插入临时任务）" class="headerlink" title="18.保存现场，（开发过程插入临时任务）"></a>18.保存现场，（开发过程插入临时任务）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">git stash #存储现场</div><div class="line">git stash list #查看存储列表</div><div class="line">git stash apply #恢复场景</div><div class="line">git stash drop #删除场景</div><div class="line">git stash pop  #恢复并删除场景</div><div class="line">git stash apply stash@&#123;0&#125;恢复指定场景</div></pre></td></tr></table></figure>
<h2 id="19-多人协作"><a href="#19-多人协作" class="headerlink" title="19. 多人协作"></a>19. 多人协作</h2><ol>
<li><p>查看远程库信息，使用git remote -v；</p>
</li>
<li><p>本地新建的分支如果不推送到远程，对其他人就是不可见的；</p>
</li>
<li><p>从本地推送分支，使用git push origin branch-name，如果推送失败，先用git pull抓取远程的新提交；</p>
</li>
<li><p>在本地创建和远程分支对应的分支，使用git checkout -b branch-name origin/branch-name，本地和远程分支的名称最好一致；</p>
</li>
<li><p>建立本地分支和远程分支的关联，使用git branch –set-upstream branch-name origin/branch-name；</p>
</li>
<li><p>从远程抓取分支，使用git pull，如果有冲突，要先处理冲突。</p>
</li>
</ol>
<h2 id="20-标签"><a href="#20-标签" class="headerlink" title="20. 标签"></a>20. 标签</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">git tag &lt;tagname&gt; #创建一个标签</div><div class="line">git tag &lt;tagname&gt; &lt;commit&gt; #指定commit ID 创建一个标签</div><div class="line">git tag -a &lt;tagname&gt; -m &quot;创建标签&quot; #指定标签信息</div><div class="line">git show &lt;tagname&gt; #查看某个标签详情</div><div class="line">git tag #查看所有标签</div><div class="line">git tag -n #查看所有标签与注解</div><div class="line">git push origin &lt;tagname&gt; #可以推送一个本地标签</div><div class="line">git push origin --tags  #可以推送全部未推送过的本地标签</div><div class="line">git tag -d &lt;tagname&gt; #可以删除一个本地标签</div><div class="line">git push origin :refs/tags/&lt;tagname&gt; #删除一个远程标签</div></pre></td></tr></table></figure>
<h2 id="21-根据标签创建一个分支"><a href="#21-根据标签创建一个分支" class="headerlink" title="21.根据标签创建一个分支"></a>21.根据标签创建一个分支</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git branch &lt;new-branch-name&gt; &lt;tag-name&gt;</div></pre></td></tr></table></figure>
<h2 id="22-归档"><a href="#22-归档" class="headerlink" title="22.归档"></a>22.归档</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git archive -o ../latest.zip HEAD #导出最新的版本库</div><div class="line">git archive -o ../git-1.4.0-docs.zip  HEAD:Documentation/ #导出一个目录</div><div class="line">git archive --format=tar --remote=git@gitlab.kmlab.com:template/saas-server.git master server/ public/ .env/ index.js | tar -xf -</div></pre></td></tr></table></figure>
<h1 id="⚠️"><a href="#⚠️" class="headerlink" title="⚠️"></a>⚠️</h1><ol>
<li>不同类别的修改 (如：Bug修复和功能添加) 要尽量分开提交，以方便以后从历史记录里查找特定的修改内容。</li>
<li>查看其他人提交的修改内容或自己的历史记录的时候，提交信息是需要用到的重要资料。所以请用心填写修改内容的提交信息，以方便别人理解。<br>以下是Git的标准注解：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">第1行：提交修改内容的摘要</div><div class="line">第2行：空行</div><div class="line">第3行以后：修改的理由</div></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/08/omniplan-许可证/" itemprop="url">
                  omniplan 许可证
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-05-08T18:31:26+08:00" content="2017-05-08">
              2017-05-08
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/05/08/omniplan-许可证/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/05/08/omniplan-许可证/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2017/05/08/omniplan-许可证/" class="leancloud_visitors" data-flag-title="omniplan 许可证">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://www.jianshu.com/p/28b2d21e33c4" target="_blank" rel="external"> 原地址</a></p>
<p><strong>密钥所有者都是:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">youliyuan</div></pre></td></tr></table></figure></p>
<p><strong>OmniPlan 3：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">HOMJ-QOJH-OIBN-TNIH-HWUN-TEEH-WUN</div><div class="line">NKWO-HVKB-JAZE-UIHH-XAVY-BEEX-AVY</div><div class="line">BCRW-MFCE-FVEX-VEBS-LNYD-PEEL-NYD</div></pre></td></tr></table></figure></p>
<p><strong>OmniPlan 3 Pro：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">CQPC-NNAM-MMMG-XYKD-IDPA-BEEI-DPA</div><div class="line">LEUG-ZSCB-WJYR-LXIK-DHXG-VEED-HXG</div><div class="line">MWCD-CCHB-DLNR-RSNF-UVBX-TEEU-VBX</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/15/413-request-entity-too-large-解决/" itemprop="url">
                  413 request entity too large 解决
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-03-15T10:44:31+08:00" content="2017-03-15">
              2017-03-15
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/03/15/413-request-entity-too-large-解决/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/03/15/413-request-entity-too-large-解决/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2017/03/15/413-request-entity-too-large-解决/" class="leancloud_visitors" data-flag-title="413 request entity too large 解决">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="如果是nginx-问题"><a href="#如果是nginx-问题" class="headerlink" title="如果是nginx 问题"></a>如果是nginx 问题</h2><p><strong>在nginx 配置中写入</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">增加如下两行到nginx.conf的http&#123;&#125;段， 增大nginx上传文件大小限制</div><div class="line"></div><div class="line">#设置允许发布内容为8M</div><div class="line">client_max_body_size 8M;</div><div class="line">client_body_buffer_size 128k;</div></pre></td></tr></table></figure></p>
<h2 id="如果是在express中"><a href="#如果是在express中" class="headerlink" title="如果是在express中"></a>如果是在express中</h2><p><strong>使用body-parser中间件</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">// 定义express body 中间件</div><div class="line">app.use(bodyParser.urlencoded(&#123; extended: false , limit: &apos;8mb&apos;&#125;));</div><div class="line">app.use(bodyParser.json(&#123;limit: &apos;8mb&apos;&#125;));</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/27/http 状态码简单记录/" itemprop="url">
                  http 状态码简单记录
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-02-27T15:49:06+08:00" content="2017-02-27">
              2017-02-27
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/02/27/http 状态码简单记录/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/27/http 状态码简单记录/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2017/02/27/http 状态码简单记录/" class="leancloud_visitors" data-flag-title="http 状态码简单记录">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-分类以及描述"><a href="#1-分类以及描述" class="headerlink" title="1.分类以及描述"></a>1.分类以及描述</h2><table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">分类</td>
<td style="text-align:center">分类描述</td>
</tr>
<tr>
<td style="text-align:center">1**</td>
<td style="text-align:center">信息，服务器收到请求，需要请求者继续执行操作</td>
</tr>
<tr>
<td style="text-align:center">2**</td>
<td style="text-align:center">成功，操作被成功接收并处理</td>
</tr>
<tr>
<td style="text-align:center">3**</td>
<td style="text-align:center">重定向，需要进一步的操作以完成请求</td>
</tr>
<tr>
<td style="text-align:center">4**</td>
<td style="text-align:center">客户端错误，请求包含语法错误或无法完成请求</td>
</tr>
<tr>
<td style="text-align:center">5**</td>
<td style="text-align:center">服务器错误，服务器在处理请求的过程中发生了错误</td>
</tr>
</tbody>
</table>
<h2 id="2-http-状态码简单记录"><a href="#2-http-状态码简单记录" class="headerlink" title="2.http 状态码简单记录"></a>2.http 状态码简单记录</h2><table>
<thead>
<tr>
<th style="text-align:center">码</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">100</td>
<td style="text-align:center">客户端应当继续发送请求。这个临时响应是用来通知客户端它的部分请求已经被服务器接收，且仍未被拒绝。客户端应当继续发送请求的剩余部分，或者如果请求已经完成，忽略这个响应。服务器必须在请求完成后向客户端发送一个最终响应。</td>
</tr>
<tr>
<td style="text-align:center">101</td>
<td style="text-align:center">服务器已经理解了客户端的请求，并将通过Upgrade 消息头通知客户端采用不同的协议来完成这个请求。在发送完这个响应最后的空行后，服务器将会切换到在Upgrade 消息头中定义的那些协议。 　　只有在切换新的协议更有好处的时候才应该采取类似措施。例如，切换到新的HTTP 版本比旧版本更有优势，或者切换到一个实时且同步的协议以传送利用此类特性的资源。</td>
</tr>
<tr>
<td style="text-align:center">102</td>
<td style="text-align:center">由WebDAV（RFC 2518）扩展的状态码，代表处理将被继续执行。</td>
</tr>
<tr>
<td style="text-align:center">200</td>
<td style="text-align:center">请求已成功，请求所希望的响应头或数据体将随此响应返回。</td>
</tr>
<tr>
<td style="text-align:center">201</td>
<td style="text-align:center">请求已经被实现，而且有一个新的资源已经依据请求的需要而建立，且其 URI 已经随Location 头信息返回。假如需要的资源无法及时建立的话，应当返回 ‘202 Accepted’。</td>
</tr>
<tr>
<td style="text-align:center">202</td>
<td style="text-align:center">服务器已接受请求，但尚未处理。正如它可能被拒绝一样，最终该请求可能会也可能不会被执行。在异步操作的场合下，没有比发送这个状态码更方便的做法了。 　　返回202状态码的响应的目的是允许服务器接受其他过程的请求（例如某个每天只执行一次的基于批处理的操作），而不必让客户端一直保持与服务器的连接直到批处理操作全部完成。在接受请求处理并返回202状态码的响应应当在返回的实体中包含一些指示处理当前状态的信息，以及指向处理状态监视器或状态预测的指针，以便用户能够估计操作是否已经完成。</td>
</tr>
<tr>
<td style="text-align:center">203</td>
<td style="text-align:center">服务器已成功处理了请求，但返回的实体头部元信息不是在原始服务器上有效的确定集合，而是来自本地或者第三方的拷贝。当前的信息可能是原始版本的子集或者超集。例如，包含资源的元数据可能导致原始服务器知道元信息的超级。使用此状态码不是必须的，而且只有在响应不使用此状态码便会返回200 OK的情况下才是合适的。</td>
</tr>
<tr>
<td style="text-align:center">204</td>
<td style="text-align:center">服务器成功处理了请求，但不需要返回任何实体内容，并且希望返回更新了的元信息。响应可能通过实体头部的形式，返回新的或更新后的元信息。如果存在这些头部信息，则应当与所请求的变量相呼应。 　　如果客户端是浏览器的话，那么用户浏览器应保留发送了该请求的页面，而不产生任何文档视图上的变化，即使按照规范新的或更新后的元信息应当被应用到用户浏览器活动视图中的文档。 　　由于204响应被禁止包含任何消息体，因此它始终以消息头后的第一个空行结尾。</td>
</tr>
<tr>
<td style="text-align:center">205</td>
<td style="text-align:center">服务器成功处理了请求，且没有返回任何内容。但是与204响应不同，返回此状态码的响应要求请求者重置文档视图。该响应主要是被用于接受用户输入后，立即重置表单，以便用户能够轻松地开始另一次输入。 　　与204响应一样，该响应也被禁止包含任何消息体，且以消息头后的第一个空行结束。</td>
</tr>
<tr>
<td style="text-align:center">206</td>
<td style="text-align:center">服务器已经成功处理了部分 GET 请求。类似于 FlashGet 或者迅雷这类的 HTTP 下载工具都是使用此类响应实现断点续传或者将一个大文档分解为多个下载段同时下载。 　　该请求必须包含 Range 头信息来指示客户端希望得到的内容范围，并且可能包含 If-Range 来作为请求条件。 　　响应必须包含如下的头部域： 　　Content-Range 用以指示本次响应中返回的内容的范围；如果是 Content-Type 为 multipart/byteranges 的多段下载，则每一 multipart 段中都应包含 Content-Range 域用以指示本段的内容范围。假如响应中包含 Content-Length，那么它的数值必须匹配它返回的内容范围的真实字节数。 　　Date 　　ETag 和/或 Content-Location，假如同样的请求本应该返回200响应。 　　Expires, Cache-Control，和/或 Vary，假如其值可能与之前相同变量的其他响应对应的值不同的话。 　　假如本响应请求使用了 If-Range 强缓存验证，那么本次响应不应该包含其他实体头；假如本响应的请求使用了 If-Range 弱缓存验证，那么本次响应禁止包含其他实体头；这避免了缓存的实体内容和更新了的实体头信息之间的不一致。否则，本响应就应当包含所有本应该返回200响应中应当返回的所有实体头部域。 　　假如 ETag 或 Last-Modified 头部不能精确匹配的话，则客户端缓存应禁止将206响应返回的内容与之前任何缓存过的内容组合在一起。 　　任何不支持 Range 以及 Content-Range 头的缓存都禁止缓存206响应返回的内容。</td>
</tr>
<tr>
<td style="text-align:center">207</td>
<td style="text-align:center">由WebDAV(RFC 2518)扩展的状态码，代表之后的消息体将是一个XML消息，并且可能依照之前子请求数量的不同，包含一系列独立的响应代码。</td>
</tr>
<tr>
<td style="text-align:center">300</td>
<td style="text-align:center">被请求的资源有一系列可供选择的回馈信息，每个都有自己特定的地址和浏览器驱动的商议信息。用户或浏览器能够自行选择一个首选的地址进行重定向。 　　除非这是一个 HEAD 请求，否则该响应应当包括一个资源特性及地址的列表的实体，以便用户或浏览器从中选择最合适的重定向地址。这个实体的格式由 Content-Type 定义的格式所决定。浏览器可能根据响应的格式以及浏览器自身能力，自动作出最合适的选择。当然，RFC 2616规范并没有规定这样的自动选择该如何进行。 　　如果服务器本身已经有了首选的回馈选择，那么在 Location 中应当指明这个回馈的 URI；浏览器可能会将这个 Location 值作为自动重定向的地址。此外，除非额外指定，否则这个响应也是可缓存的。</td>
</tr>
<tr>
<td style="text-align:center">301</td>
<td style="text-align:center">被请求的资源已永久移动到新位置，并且将来任何对此资源的引用都应该使用本响应返回的若干个 URI 之一。如果可能，拥有链接编辑功能的客户端应当自动把请求的地址修改为从服务器反馈回来的地址。除非额外指定，否则这个响应也是可缓存的。 　　新的永久性的 URI 应当在响应的 Location 域中返回。除非这是一个 HEAD 请求，否则响应的实体中应当包含指向新的 URI 的超链接及简短说明。 　　如果这不是一个 GET 或者 HEAD 请求，因此浏览器禁止自动进行重定向，除非得到用户的确认，因为请求的条件可能因此发生变化。 　　注意：对于某些使用 HTTP/1.0 协议的浏览器，当它们发送的 POST 请求得到了一个301响应的话，接下来的重定向请求将会变成 GET 方式。</td>
</tr>
<tr>
<td style="text-align:center">302</td>
<td style="text-align:center">请求的资源现在临时从不同的 URI 响应请求。由于这样的重定向是临时的，客户端应当继续向原有地址发送以后的请求。只有在Cache-Control或Expires中进行了指定的情况下，这个响应才是可缓存的。 　　新的临时性的 URI 应当在响应的 Location 域中返回。除非这是一个 HEAD 请求，否则响应的实体中应当包含指向新的 URI 的超链接及简短说明。 　　如果这不是一个 GET 或者 HEAD 请求，那么浏览器禁止自动进行重定向，除非得到用户的确认，因为请求的条件可能因此发生变化。 　　注意：虽然RFC 1945和RFC 2068规范不允许客户端在重定向时改变请求的方法，但是很多现存的浏览器将302响应视作为303响应，并且使用 GET 方式访问在 Location 中规定的 URI，而无视原先请求的方法。状态码303和307被添加了进来，用以明确服务器期待客户端进行何种反应。</td>
</tr>
<tr>
<td style="text-align:center">303</td>
<td style="text-align:center">对应当前请求的响应可以在另一个 URI 上被找到，而且客户端应当采用 GET 的方式访问那个资源。这个方法的存在主要是为了允许由脚本激活的POST请求输出重定向到一个新的资源。这个新的 URI 不是原始资源的替代引用。同时，303响应禁止被缓存。当然，第二个请求（重定向）可能被缓存。 　　新的 URI 应当在响应的 Location 域中返回。除非这是一个 HEAD 请求，否则响应的实体中应当包含指向新的 URI 的超链接及简短说明。 　　注意：许多 HTTP/1.1 版以前的 浏览器不能正确理解303状态。如果需要考虑与这些浏览器之间的互动，302状态码应该可以胜任，因为大多数的浏览器处理302响应时的方式恰恰就是上述规范要求客户端处理303响应时应当做的。</td>
</tr>
<tr>
<td style="text-align:center">304</td>
<td style="text-align:center">如果客户端发送了一个带条件的 GET 请求且该请求已被允许，而文档的内容（自上次访问以来或者根据请求的条件）并没有改变，则服务器应当返回这个状态码。304响应禁止包含消息体，因此始终以消息头后的第一个空行结尾。 　　该响应必须包含以下的头信息： 　　Date，除非这个服务器没有时钟。假如没有时钟的服务器也遵守这些规则，那么代理服务器以及客户端可以自行将 Date 字段添加到接收到的响应头中去（正如RFC 2068中规定的一样），缓存机制将会正常工作。 　　ETag 和/或 Content-Location，假如同样的请求本应返回200响应。 　　Expires, Cache-Control，和/或Vary，假如其值可能与之前相同变量的其他响应对应的值不同的话。 　　假如本响应请求使用了强缓存验证，那么本次响应不应该包含其他实体头；否则（例如，某个带条件的 GET 请求使用了弱缓存验证），本次响应禁止包含其他实体头；这避免了缓存了的实体内容和更新了的实体头信息之间的不一致。 　　假如某个304响应指明了当前某个实体没有缓存，那么缓存系统必须忽视这个响应，并且重复发送不包含限制条件的请求。 　　假如接收到一个要求更新某个缓存条目的304响应，那么缓存系统必须更新整个条目以反映所有在响应中被更新的字段的值。</td>
</tr>
<tr>
<td style="text-align:center">305</td>
<td style="text-align:center">被请求的资源必须通过指定的代理才能被访问。Location 域中将给出指定的代理所在的 URI 信息，接收者需要重复发送一个单独的请求，通过这个代理才能访问相应资源。只有原始服务器才能建立305响应。 　　注意：RFC 2068中没有明确305响应是为了重定向一个单独的请求，而且只能被原始服务器建立。忽视这些限制可能导致严重的安全后果。</td>
</tr>
<tr>
<td style="text-align:center">306</td>
<td style="text-align:center">在最新版的规范中，306状态码已经不再被使用。</td>
</tr>
<tr>
<td style="text-align:center">307</td>
<td style="text-align:center">请求的资源现在临时从不同的URI 响应请求。由于这样的重定向是临时的，客户端应当继续向原有地址发送以后的请求。只有在Cache-Control或Expires中进行了指定的情况下，这个响应才是可缓存的。 　　新的临时性的URI 应当在响应的 Location 域中返回。除非这是一个HEAD 请求，否则响应的实体中应当包含指向新的URI 的超链接及简短说明。因为部分浏览器不能识别307响应，因此需要添加上述必要信息以便用户能够理解并向新的 URI 发出访问请求。 　　如果这不是一个GET 或者 HEAD 请求，那么浏览器禁止自动进行重定向，除非得到用户的确认，因为请求的条件可能因此发生变化。</td>
</tr>
<tr>
<td style="text-align:center">400</td>
<td style="text-align:center">1、语义有误，当前请求无法被服务器理解。除非进行修改，否则客户端不应该重复提交这个请求。 　　2、请求参数有误。</td>
</tr>
<tr>
<td style="text-align:center">401</td>
<td style="text-align:center">当前请求需要用户验证。该响应必须包含一个适用于被请求资源的 WWW-Authenticate 信息头用以询问用户信息。客户端可以重复提交一个包含恰当的 Authorization 头信息的请求。如果当前请求已经包含了 Authorization 证书，那么401响应代表着服务器验证已经拒绝了那些证书。如果401响应包含了与前一个响应相同的身份验证询问，且浏览器已经至少尝试了一次验证，那么浏览器应当向用户展示响应中包含的实体信息，因为这个实体信息中可能包含了相关诊断信息。参见RFC 2617。</td>
</tr>
<tr>
<td style="text-align:center">402</td>
<td style="text-align:center">该状态码是为了将来可能的需求而预留的。</td>
</tr>
<tr>
<td style="text-align:center">403</td>
<td style="text-align:center">服务器已经理解请求，但是拒绝执行它。与401响应不同的是，身份验证并不能提供任何帮助，而且这个请求也不应该被重复提交。如果这不是一个 HEAD 请求，而且服务器希望能够讲清楚为何请求不能被执行，那么就应该在实体内描述拒绝的原因。当然服务器也可以返回一个404响应，假如它不希望让客户端获得任何信息。</td>
</tr>
<tr>
<td style="text-align:center">404</td>
<td style="text-align:center">请求失败，请求所希望得到的资源未被在服务器上发现。没有信息能够告诉用户这个状况到底是暂时的还是永久的。假如服务器知道情况的话，应当使用410状态码来告知旧资源因为某些内部的配置机制问题，已经永久的不可用，而且没有任何可以跳转的地址。404这个状态码被广泛应用于当服务器不想揭示到底为何请求被拒绝或者没有其他适合的响应可用的情况下。</td>
</tr>
<tr>
<td style="text-align:center">405</td>
<td style="text-align:center">请求行中指定的请求方法不能被用于请求相应的资源。该响应必须返回一个Allow 头信息用以表示出当前资源能够接受的请求方法的列表。 　　鉴于 PUT，DELETE 方法会对服务器上的资源进行写操作，因而绝大部分的网页服务器都不支持或者在默认配置下不允许上述请求方法，对于此类请求均会返回405错误。</td>
</tr>
<tr>
<td style="text-align:center">406</td>
<td style="text-align:center">请求的资源的内容特性无法满足请求头中的条件，因而无法生成响应实体。 　　除非这是一个 HEAD 请求，否则该响应就应当返回一个包含可以让用户或者浏览器从中选择最合适的实体特性以及地址列表的实体。实体的格式由 Content-Type 头中定义的媒体类型决定。浏览器可以根据格式及自身能力自行作出最佳选择。但是，规范中并没有定义任何作出此类自动选择的标准。</td>
</tr>
<tr>
<td style="text-align:center">407</td>
<td style="text-align:center">与401响应类似，只不过客户端必须在代理服务器上进行身份验证。代理服务器必须返回一个 Proxy-Authenticate 用以进行身份询问。客户端可以返回一个 Proxy-Authorization 信息头用以验证。参见RFC 2617。</td>
</tr>
<tr>
<td style="text-align:center">408</td>
<td style="text-align:center">请求超时。客户端没有在服务器预备等待的时间内完成一个请求的发送。客户端可以随时再次提交这一请求而无需进行任何更改。</td>
</tr>
<tr>
<td style="text-align:center">409</td>
<td style="text-align:center">由于和被请求的资源的当前状态之间存在冲突，请求无法完成。这个代码只允许用在这样的情况下才能被使用：用户被认为能够解决冲突，并且会重新提交新的请求。该响应应当包含足够的信息以便用户发现冲突的源头。 　　冲突通常发生于对 PUT 请求的处理中。例如，在采用版本检查的环境下，某次 PUT 提交的对特定资源的修改请求所附带的版本信息与之前的某个（第三方）请求向冲突，那么此时服务器就应该返回一个409错误，告知用户请求无法完成。此时，响应实体中很可能会包含两个冲突版本之间的差异比较，以便用户重新提交归并以后的新版本。</td>
</tr>
<tr>
<td style="text-align:center">410</td>
<td style="text-align:center">被请求的资源在服务器上已经不再可用，而且没有任何已知的转发地址。这样的状况应当被认为是永久性的。如果可能，拥有链接编辑功能的客户端应当在获得用户许可后删除所有指向这个地址的引用。如果服务器不知道或者无法确定这个状况是否是永久的，那么就应该使用404状态码。除非额外说明，否则这个响应是可缓存的。 　　410响应的目的主要是帮助网站管理员维护网站，通知用户该资源已经不再可用，并且服务器拥有者希望所有指向这个资源的远端连接也被删除。这类事件在限时、增值服务中很普遍。同样，410响应也被用于通知客户端在当前服务器站点上，原本属于某个个人的资源已经不再可用。当然，是否需要把所有永久不可用的资源标记为’410 Gone’，以及是否需要保持此标记多长时间，完全取决于服务器拥有者。</td>
</tr>
<tr>
<td style="text-align:center">411</td>
<td style="text-align:center">服务器拒绝在没有定义 Content-Length 头的情况下接受请求。在添加了表明请求消息体长度的有效 Content-Length 头之后，客户端可以再次提交该请求。</td>
</tr>
<tr>
<td style="text-align:center">412</td>
<td style="text-align:center">服务器在验证在请求的头字段中给出先决条件时，没能满足其中的一个或多个。这个状态码允许客户端在获取资源时在请求的元信息（请求头字段数据）中设置先决条件，以此避免该请求方法被应用到其希望的内容以外的资源上。</td>
</tr>
<tr>
<td style="text-align:center">413</td>
<td style="text-align:center">服务器拒绝处理当前请求，因为该请求提交的实体数据大小超过了服务器愿意或者能够处理的范围。此种情况下，服务器可以关闭连接以免客户端继续发送此请求。 　　如果这个状况是临时的，服务器应当返回一个 Retry-After 的响应头，以告知客户端可以在多少时间以后重新尝试。</td>
</tr>
<tr>
<td style="text-align:center">414</td>
<td style="text-align:center">请求的URI 长度超过了服务器能够解释的长度，因此服务器拒绝对该请求提供服务。这比较少见，通常的情况包括： 　　本应使用POST方法的表单提交变成了GET方法，导致查询字符串（Query String）过长。 　　重定向URI “黑洞”，例如每次重定向把旧的 URI 作为新的 URI 的一部分，导致在若干次重定向后 URI 超长。 　　客户端正在尝试利用某些服务器中存在的安全漏洞攻击服务器。这类服务器使用固定长度的缓冲读取或操作请求的 URI，当 GET 后的参数超过某个数值后，可能会产生缓冲区溢出，导致任意代码被执行[1]。没有此类漏洞的服务器，应当返回414状态码。</td>
</tr>
<tr>
<td style="text-align:center">415</td>
<td style="text-align:center">对于当前请求的方法和所请求的资源，请求中提交的实体并不是服务器中所支持的格式，因此请求被拒绝。</td>
</tr>
<tr>
<td style="text-align:center">416</td>
<td style="text-align:center">如果请求中包含了 Range 请求头，并且 Range 中指定的任何数据范围都与当前资源的可用范围不重合，同时请求中又没有定义 If-Range 请求头，那么服务器就应当返回416状态码。 　　假如 Range 使用的是字节范围，那么这种情况就是指请求指定的所有数据范围的首字节位置都超过了当前资源的长度。服务器也应当在返回416状态码的同时，包含一个 Content-Range 实体头，用以指明当前资源的长度。这个响应也被禁止使用 multipart/byteranges 作为其 Content-Type。</td>
</tr>
<tr>
<td style="text-align:center">417</td>
<td style="text-align:center">在请求头 Expect 中指定的预期内容无法被服务器满足，或者这个服务器是一个代理服务器，它有明显的证据证明在当前路由的下一个节点上，Expect 的内容无法被满足。</td>
</tr>
<tr>
<td style="text-align:center">421</td>
<td style="text-align:center">从当前客户端所在的IP地址到服务器的连接数超过了服务器许可的最大范围。通常，这里的IP地址指的是从服务器上看到的客户端地址（比如用户的网关或者代理服务器地址）。在这种情况下，连接数的计算可能涉及到不止一个终端用户。</td>
</tr>
<tr>
<td style="text-align:center">422</td>
<td style="text-align:center">从当前客户端所在的IP地址到服务器的连接数超过了服务器许可的最大范围。通常，这里的IP地址指的是从服务器上看到的客户端地址（比如用户的网关或者代理服务器地址）。在这种情况下，连接数的计算可能涉及到不止一个终端用户。</td>
</tr>
<tr>
<td style="text-align:center">422</td>
<td style="text-align:center">请求格式正确，但是由于含有语义错误，无法响应。（RFC 4918 WebDAV）423 Locked 　　当前资源被锁定。（RFC 4918 WebDAV）</td>
</tr>
<tr>
<td style="text-align:center">424</td>
<td style="text-align:center">由于之前的某个请求发生的错误，导致当前请求失败，例如 PROPPATCH。（RFC 4918 WebDAV）</td>
</tr>
<tr>
<td style="text-align:center">425</td>
<td style="text-align:center">在WebDav Advanced Collections 草案中定义，但是未出现在《WebDAV 顺序集协议》（RFC 3658）中。</td>
</tr>
<tr>
<td style="text-align:center">426</td>
<td style="text-align:center">客户端应当切换到TLS/1.0。（RFC 2817）</td>
</tr>
<tr>
<td style="text-align:center">449</td>
<td style="text-align:center">由微软扩展，代表请求应当在执行完适当的操作后进行重试。</td>
</tr>
<tr>
<td style="text-align:center">500</td>
<td style="text-align:center">服务器遇到了一个未曾预料的状况，导致了它无法完成对请求的处理。一般来说，这个问题都会在服务器的程序码出错时出现。</td>
</tr>
<tr>
<td style="text-align:center">501</td>
<td style="text-align:center">服务器不支持当前请求所需要的某个功能。当服务器无法识别请求的方法，并且无法支持其对任何资源的请求。</td>
</tr>
<tr>
<td style="text-align:center">502</td>
<td style="text-align:center">作为网关或者代理工作的服务器尝试执行请求时，从上游服务器接收到无效的响应。</td>
</tr>
<tr>
<td style="text-align:center">503</td>
<td style="text-align:center">由于临时的服务器维护或者过载，服务器当前无法处理请求。这个状况是临时的，并且将在一段时间以后恢复。如果能够预计延迟时间，那么响应中可以包含一个 Retry-After 头用以标明这个延迟时间。如果没有给出这个 Retry-After 信息，那么客户端应当以处理500响应的方式处理它。 　　注意：503状态码的存在并不意味着服务器在过载的时候必须使用它。某些服务器只不过是希望拒绝客户端的连接。</td>
</tr>
<tr>
<td style="text-align:center">504</td>
<td style="text-align:center">作为网关或者代理工作的服务器尝试执行请求时，未能及时从上游服务器（URI标识出的服务器，例如HTTP、FTP、LDAP）或者辅助服务器（例如DNS）收到响应。 　　注意：某些代理服务器在DNS查询超时时会返回400或者500错误</td>
</tr>
<tr>
<td style="text-align:center">505</td>
<td style="text-align:center">服务器不支持，或者拒绝支持在请求中使用的 HTTP 版本。这暗示着服务器不能或不愿使用与客户端相同的版本。响应中应当包含一个描述了为何版本不被支持以及服务器支持哪些协议的实体。</td>
</tr>
<tr>
<td style="text-align:center">506</td>
<td style="text-align:center">由《透明内容协商协议》（RFC 2295）扩展，代表服务器存在内部配置错误：被请求的协商变元资源被配置为在透明内容协商中使用自己，因此在一个协商处理中不是一个合适的重点。</td>
</tr>
<tr>
<td style="text-align:center">507</td>
<td style="text-align:center">服务器无法存储完成请求所必须的内容。这个状况被认为是临时的。WebDAV (RFC 4918)</td>
</tr>
<tr>
<td style="text-align:center">509</td>
<td style="text-align:center">服务器达到带宽限制。这不是一个官方的状态码，但是仍被广泛使用。</td>
</tr>
<tr>
<td style="text-align:center">510</td>
<td style="text-align:center">获取资源所需要的策略并没有没满足。（RFC 2774）</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/09/centos7-firewalld-防火墙设置/" itemprop="url">
                  centos7 systemctl 与firewalld 的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-02-09T16:20:27+08:00" content="2017-02-09">
              2017-02-09
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/02/09/centos7-firewalld-防火墙设置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/09/centos7-firewalld-防火墙设置/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2017/02/09/centos7-firewalld-防火墙设置/" class="leancloud_visitors" data-flag-title="centos7 systemctl 与firewalld 的使用">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-firewalld的基本使用"><a href="#1-firewalld的基本使用" class="headerlink" title="1.firewalld的基本使用"></a>1.firewalld的基本使用</h3><p>启动：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl start firewalld</div></pre></td></tr></table></figure></p>
<p>查看状态：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl status firewalld</div></pre></td></tr></table></figure></p>
<p>停止：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl disable firewalld</div></pre></td></tr></table></figure></p>
<p>禁用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl stop firewalld</div></pre></td></tr></table></figure></p>
<h3 id="2-systemctl是CentOS7的服务管理工具中主要的工具，它融合之前service和chkconfig的功能于一体。"><a href="#2-systemctl是CentOS7的服务管理工具中主要的工具，它融合之前service和chkconfig的功能于一体。" class="headerlink" title="2.systemctl是CentOS7的服务管理工具中主要的工具，它融合之前service和chkconfig的功能于一体。"></a>2.systemctl是CentOS7的服务管理工具中主要的工具，它融合之前service和chkconfig的功能于一体。</h3><p>启动一个服务：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl start firewalld.service</div></pre></td></tr></table></figure></p>
<p>关闭一个服务：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl stop firewalld.service</div></pre></td></tr></table></figure></p>
<p>重启一个服务：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl restart firewalld.service</div></pre></td></tr></table></figure></p>
<p>显示一个服务的状态：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl status firewalld.service</div></pre></td></tr></table></figure></p>
<p>在开机时启用一个服务：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl enable firewalld.service</div></pre></td></tr></table></figure></p>
<p>在开机时禁用一个服务：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl disable firewalld.service</div></pre></td></tr></table></figure></p>
<p>查看服务是否开机启动：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl is-enabled firewalld.service</div></pre></td></tr></table></figure></p>
<p>查看已启动的服务列表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl list-unit-files|grep enabled</div></pre></td></tr></table></figure></p>
<p>查看启动失败的服务列表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl --failed</div></pre></td></tr></table></figure></p>
<h3 id="3-配置firewalld-cmd"><a href="#3-配置firewalld-cmd" class="headerlink" title="3.配置firewalld-cmd"></a>3.配置firewalld-cmd</h3><p>查看版本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --version</div></pre></td></tr></table></figure></p>
<p>查看帮助：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --help</div></pre></td></tr></table></figure></p>
<p>显示状态：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --state</div></pre></td></tr></table></figure></p>
<p>查看所有打开的端口：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --zone=public --list-ports</div></pre></td></tr></table></figure></p>
<p>更新防火墙规则：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --reload</div></pre></td></tr></table></figure></p>
<p>查看区域信息:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --get-active-zones</div></pre></td></tr></table></figure></p>
<p>查看指定接口所属区域： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --get-zone-of-interface=eth0</div></pre></td></tr></table></figure></p>
<p>拒绝所有包：<br>​<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --panic-on</div></pre></td></tr></table></figure></p>
<p>取消拒绝状态：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --panic-off</div></pre></td></tr></table></figure></p>
<p>查看是否拒绝：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --query-panic</div></pre></td></tr></table></figure></p>
<h3 id="4-开启与关闭一个端口"><a href="#4-开启与关闭一个端口" class="headerlink" title="4.开启与关闭一个端口"></a>4.开启与关闭一个端口</h3><p>添加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --zone=public --add-port=80/tcp --permanent    （--permanent永久生效，没有此参数重启后失效）</div></pre></td></tr></table></figure></p>
<p>重新载入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --reload</div></pre></td></tr></table></figure></p>
<p>查看<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --zone= public --query-port=80/tcp</div></pre></td></tr></table></figure></p>
<p>删除<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">firewall-cmd --zone= public --remove-port=80/tcp --permanent</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/09/“将程序部署到docker里面”/" itemprop="url">
                  “将程序部署到docker里面”
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-12-09T12:03:20+08:00" content="2016-12-09">
              2016-12-09
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/12/09/“将程序部署到docker里面”/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/09/“将程序部署到docker里面”/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/12/09/“将程序部署到docker里面”/" class="leancloud_visitors" data-flag-title="“将程序部署到docker里面”">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="redis-安装"><a href="#redis-安装" class="headerlink" title="redis 安装"></a>redis 安装</h1><h2 id="1-下载官方镜像"><a href="#1-下载官方镜像" class="headerlink" title="1. 下载官方镜像"></a>1. 下载官方镜像</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker pull redis:latest</div></pre></td></tr></table></figure>
<h2 id="2-运行redis"><a href="#2-运行redis" class="headerlink" title="2.运行redis"></a>2.运行redis</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker run --name myRedis -d redis</div></pre></td></tr></table></figure>
<h2 id="3-运行一个redis终端"><a href="#3-运行一个redis终端" class="headerlink" title="3.运行一个redis终端"></a>3.运行一个redis终端</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker run -it --link myRedis:redis --rm redis redis-cli -h redis -p 6379</div></pre></td></tr></table></figure>
<ul>
<li><a href="https://hub.docker.com/_/redis/" target="_blank" rel="external">redis Image</a></li>
</ul>
<h1 id="postgresql-安装"><a href="#postgresql-安装" class="headerlink" title="postgresql 安装"></a>postgresql 安装</h1><h2 id="1-下载官方镜像-1"><a href="#1-下载官方镜像-1" class="headerlink" title="1.下载官方镜像"></a>1.下载官方镜像</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker pull postgres:latest</div></pre></td></tr></table></figure>
<h2 id="2-运行postgresql"><a href="#2-运行postgresql" class="headerlink" title="2.运行postgresql"></a>2.运行postgresql</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker run --name myPG -e POSTGRES_PASSWORD=mysecretpassword -d postgres</div></pre></td></tr></table></figure>
<h2 id="3-运行一个postgresql终端"><a href="#3-运行一个postgresql终端" class="headerlink" title="3.运行一个postgresql终端"></a>3.运行一个postgresql终端</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">docker run -it --rm --link myPG:postgres postgres psql -h postgres -U postgres</div><div class="line">psql (9.5.0)</div></pre></td></tr></table></figure>
<ul>
<li><a href="https://hub.docker.com/_/postgres/" target="_blank" rel="external">Postres Image</a></li>
</ul>
<h1 id="程序运行环境"><a href="#程序运行环境" class="headerlink" title="程序运行环境"></a>程序运行环境</h1><h2 id="1-Dockerfile-文件"><a href="#1-Dockerfile-文件" class="headerlink" title="1.Dockerfile 文件"></a>1.Dockerfile 文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">FROM node</div><div class="line"></div><div class="line">RUN mkdir -p /opt/hema-img/appimg</div><div class="line">WORKDIR /code/hema-back</div><div class="line"></div><div class="line">EXPOSE 3150</div><div class="line"></div><div class="line">CMD node index.js</div></pre></td></tr></table></figure>
<h2 id="2-创建Images"><a href="#2-创建Images" class="headerlink" title="2.创建Images"></a>2.创建Images</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker build -t hema:v1 ./</div></pre></td></tr></table></figure>
<h2 id="3-配置文件"><a href="#3-配置文件" class="headerlink" title="3.配置文件"></a>3.配置文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  host = `pg`;</div><div class="line">      port = 5432;</div><div class="line">      database = `hema`;</div><div class="line">      username = `postgres`;</div><div class="line">      password = `mysecretpassword`;</div><div class="line">      redisHost = `rds`;</div><div class="line">      redisPort = 6379</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="4-开启一个容器"><a href="#4-开启一个容器" class="headerlink" title="4.开启一个容器"></a>4.开启一个容器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker run -d --restart=&quot;always&quot; --link myPG:pg --link myRedis:rds -p 3150:3150 --name hema_back -v /Users/yujintang/Documents/Kitematic/hema_back/code/:/code hema:v1</div></pre></td></tr></table></figure>
<h2 id="5-etc-hosts-文件内容"><a href="#5-etc-hosts-文件内容" class="headerlink" title="5. /etc/hosts 文件内容"></a>5. /etc/hosts 文件内容</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">127.0.0.1	localhost</div><div class="line">::1	localhost ip6-localhost ip6-loopback</div><div class="line">fe00::0	ip6-localnet</div><div class="line">ff00::0	ip6-mcastprefix</div><div class="line">ff02::1	ip6-allnodes</div><div class="line">ff02::2	ip6-allrouters</div><div class="line">172.17.0.2	pg e4436a9e80ac myPG</div><div class="line">172.17.0.3	rds fc0b8d5b271a myRedis</div><div class="line">172.17.0.4	4e10a378dba6</div></pre></td></tr></table></figure>
<h2 id="6-查看端口占用"><a href="#6-查看端口占用" class="headerlink" title="6.查看端口占用"></a>6.查看端口占用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ lsof -n -P -i TCP -s TCP:LISTEN | grep 3150 | awk &apos;&#123;print $1,$2,$9&#125;&apos;</div><div class="line">com.docke 90186 *:3150</div><div class="line">com.docke 90186 [::1]:3150</div></pre></td></tr></table></figure>
<ul>
<li>docker 映射只绑定127.0.0.1端口，所以这个时候我们在宿主机再开启一个3150端口应用，还是可以的，但是反过来就不可以。<br>node 开启一个3150 端口应用后查看端口占用：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ lsof -n -P -i TCP -s TCP:LISTEN | grep 3150 | awk &apos;&#123;print $1,$2,$9&#125;&apos;</div><div class="line">com.docke 90186 *:3150</div><div class="line">com.docke 90186 [::1]:3150</div></pre></td></tr></table></figure></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="flynn" />
          <p class="site-author-name" itemprop="name">flynn</p>
          <p class="site-description motion-element" itemprop="description">靡不有初,鲜克有终</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">45</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/yujintang" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/13foryou" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://baidu.com/" title="百度" target="_blank">百度</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">flynn</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"yujintang"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  






  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').mousedown(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("3vcCb1NkQBRLUvnzW1WFN8ok-gzGzoHsz", "PQkJCrrDQSDhu2modCKgt3XP");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
